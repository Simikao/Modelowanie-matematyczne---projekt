polygon(c(3, 5, 5, 3), c(0, 0, density(3), density(3)), col = "green", border = NA)
polygon(c(0, 1, 1, 0), c(0, 0, density(1), density(1)), col = "green", border = NA)
polygon(c(1, 3, 3, 1), c(0, 0, density(3), density(3)), col = "red", border = NA)
lambda <- 2
# Definicja funkcji gęstości
density <- function(x) lambda * exp(-lambda * x)
cumulative_distribution <- function(x) 1 - exp(-lambda * x)
probability_X_gt_3 <- 1 - cumulative_distribution(3)
probability_X_leq_1 <- cumulative_distribution(1)
probability_1_lt_X_lt_3 <- cumulative_distribution(3) - cumulative_distribution(1)
x <- seq(0, 5, by = 0.01)
y <- density(x)
plot(x, y, type = "l", col = "blue", lwd = 2, ylim = c(0, max(y) + 0.2),
xlab = "x", ylab = "Density", main = "Density Function")
abline(v = 3, col = "red", lty = 2)
text(3, max(y) + 0.1, "x = 3", pos = 3, col = "red")
abline(v = 1, col = "green", lty = 2)
text(1, max(y) + 0.1, "x = 1", pos = 3, col = "green")
polygon(c(3, 5, 5, 3), c(0, 0, density(3), density(3)), col = "green", border = NA)
polygon(c(0, 1, 1, 0), c(0, 0, density(1), density(1)), col = "green", border = NA)
polygon(c(1, 3, 3, 1), c(0, 0, density(3), density(3)), col = "red", border = NA)
density(3)
density(1)
lambda <- 2
# Definicja funkcji gęstości
density <- function(x) lambda * exp(-lambda * x)
cumulative_distribution <- function(x) 1 - exp(-lambda * x)
probability_X_gt_3 <- 1 - cumulative_distribution(3)
probability_X_leq_1 <- cumulative_distribution(1)
probability_1_lt_X_lt_3 <- cumulative_distribution(3) - cumulative_distribution(1)
x <- seq(0, 3, by = 0.01)
y <- density(x)
plot(x, y, type = "l", col = "blue", lwd = 2, ylim = c(0, max(y) + 0.2),
xlab = "x", ylab = "Density", main = "Density Function")
abline(v = 3, col = "red", lty = 2)
text(3, max(y) + 0.1, "x = 3", pos = 3, col = "red")
abline(v = 1, col = "green", lty = 2)
text(1, max(y) + 0.1, "x = 1", pos = 3, col = "green")
polygon(c(3, 5, 5, 3), c(0, 0, density(3), density(3)), col = "green", border = NA)
polygon(c(0, 1, 1, 0), c(0, 0, density(1), density(1)), col = "green", border = NA)
polygon(c(1, 3, 3, 1), c(0, 0, density(3), density(3)), col = "red", border = NA)
density(3)
density(1)
lambda <- 2
# Definicja funkcji gęstości
density <- function(x) lambda * exp(-lambda * x)
cumulative_distribution <- function(x) 1 - exp(-lambda * x)
probability_X_gt_3 <- 1 - cumulative_distribution(3)
probability_X_leq_1 <- cumulative_distribution(1)
probability_1_lt_X_lt_3 <- cumulative_distribution(3) - cumulative_distribution(1)
x <- seq(0, 3, by = 0.01)
y <- density(x)
plot(x, y, type = "l", col = "blue", lwd = 2, ylim = c(0, max(y) + 0.2),
xlab = "x", ylab = "Density", main = "Density Function")
abline(v = 3, col = "red", lty = 2)
text(3, max(y) + 0.1, "x = 3", pos = 3, col = "red")
abline(v = 1, col = "green", lty = 2)
text(1, max(y) + 0.1, "x = 1", pos = 3, col = "green")
polygon(c(3, 5, 5, 3), c(0, 0, density(3), density(3)), col = "pink", border = NA)
polygon(c(0, 1, 1, 0), c(0, 0, density(1), density(1)), col = "green", border = NA)
polygon(c(1, 3, 3, 1), c(0, 0, density(3), density(3)), col = "red", border = NA)
density(3)
density(1)
mu <- colMeans(merged_logi)
mu
b11 <- read.csv("11b_d.csv")
kurs_zamkniecia <- b11$Zamkniecie
wmg_us_d <- read.csv("wmg_us_d.csv")
kurs_zamkniecia_wmg <- wmg_us_d$Zamkniecie
wmg_us_d <- read.csv("wmg_us_d.csv")
?dnorm
?pnorm
?pexp
?integrate
integer(function(x) {x^3}, 0, 2)
integrate(function(x) {x^3}, 0, 2)
integrate(function(x) {x^3*1/2}, 0, 2)
integrate(function(x) {x^3*1/2}, -Inf, Inf)
integrate(function(x) {x^3*1/2}, 0, 2)
?pexp
integrate(function(x) {x^6*1/2}, 0, 2)
36/7
y(
library(ggplot2)
library(fitdistrplus)
# Ustawienie lokalizacij konsoli
install.packages("rstudioapi")
install.packages("rstudioapi")
# Ustawienie lokalizacij konsoli
install.packages("rstudioapi")
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
getwd()
nwg <- read.csv("nwg_d.csv")
kurs_zamkniecia <- nwg$Zamkniecie
kurs_data <- as.Date(nwg$Data)
nwgf <- data.frame(data = kurs_data, zamkniecie = kurs_zamkniecia)
log_zwroty_nwg <- diff(log(kurs_zamkniecia))
# Przycięcie pierwszego elementu kurs_data
kurs_data_cut <- kurs_data[-1]
log_zwroty_nwgdf <- data.frame(data = kurs_data_cut, log_zwroty = log_zwroty_nwg)
#-----------------------------------------
# Estymacja kwantyli 0.05, 0.5, 0.95
#-----------------------------------------
# Wartość oczekiwana
mu <- mean(log_zwroty_nwg)
# Wariancja
variance <- var(log_zwroty_nwg)
# Odchylenie standardowe
std_dev <- sqrt(variance)
# Kwantyle
quantiles <- quantile(log_returns, probs = c(0.05, 0.5, 0.95))
# Kwantyle
quantiles <- quantile(log_zwroty_nwg, probs = c(0.05, 0.5, 0.95))
# Histogram log-zwrotów z naniesionymi wynikami
hist(log_returns, breaks = 30, col = "lightblue", main = "Histogram Log-Zwrotów", xlab = "Log-Zwroty")
# Histogram log-zwrotów z naniesionymi wynikami
hist(log_zwroty_nwg, breaks = 30, col = "lightblue", main = "Histogram Log-Zwrotów", xlab = "Log-Zwroty")
abline(v = mu, col = "red", lwd = 2, lty = 2) # Średnia
abline(v = quantiles, col = c("blue", "green", "orange"), lwd = 2, lty = 2) # Kwantyle
legend("topright", legend = c("Średnia", "5% Kwantyl", "Mediana", "95% Kwantyl"),
col = c("red", "blue", "green", "orange"), lwd = 2, lty = 2)
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.001, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
library(ggplot2)
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.001, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(data = legend_data, aes(xintercept = x, color = label, linetype = label), size = 1) + # Linie z legendą
scale_color_manual(values = c("red" = "red", "blue" = "blue", "green" = "green", "orange" = "orange")) + # Kolory linii
scale_linetype_manual(values = c("Średnia" = "dashed", "5% Kwantyl" = "dotted",
"Mediana" = "dotted", "95% Kwantyl" = "dotted")) + # Typy linii
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Dodanie danych do legendy
legend_data <- data.frame(
x = c(mu, quantiles),
label = c("Średnia", "5% Kwantyl", "Mediana", "95% Kwantyl"),
color = c("red", "blue", "green", "orange"),
linetype = c("dashed", "dotted", "dotted", "dotted")
)
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(data = legend_data, aes(xintercept = x, color = label, linetype = label), size = 1) + # Linie z legendą
scale_color_manual(values = c("red" = "red", "blue" = "blue", "green" = "green", "orange" = "orange")) + # Kolory linii
scale_linetype_manual(values = c("Średnia" = "dashed", "5% Kwantyl" = "dotted",
"Mediana" = "dotted", "95% Kwantyl" = "dotted")) + # Typy linii
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Dodanie danych do legendy
legend_data <- data.frame(
x = c(mu, quantiles),
label = c("Średnia", "5% Kwantyl", "Mediana", "95% Kwantyl"),
color = c("red", "blue", "green", "orange"),
linetype = c("dashed", "dotted", "dotted", "dotted")
)
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "red", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "blue", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "green", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "orange", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "Średnia", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "Kwantyl 5%", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "Mediana", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "Kwantyl 95%", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "Średnia", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "Kwantyl 5%", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "Mediana", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "Kwantyl 95%", linetype = "dotted", size = 1) + # Kwantyl 95%
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu), color = "Średnia", linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1]), color = "Kwantyl 5%", linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2]), color = "Mediana", linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3]), color = "Kwantyl 95%", linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Pozycja legendy
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.001, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "lightblue", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
ggsave(
"img/estymacja_kwantyli_nwg.png",
plot = wykres_zwrotów,
width = 12,
height = 9,
units = "cm",
dpi = 480
)
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
wykres_kwantyli <- ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
wykres_kwantyli <- ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = "Histogram Log-Zwrotów", x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
wykres_kwantyli
ggsave(
"img/estymacja_kwantyli_nwg.png",
plot = wykres_kwantyli,
width = 12,
height = 9,
units = "cm",
dpi = 480
)
#-----------------------------------------
# Estymacja kwantyli 0.05, 0.5, 0.95
#-----------------------------------------
# Wartość oczekiwana
mu <- mean(log_zwroty_nwg)
# Wariancja
variance <- var(log_zwroty_nwg)
# Odchylenie standardowe
std_dev <- sqrt(variance)
# Kwantyle
quantiles <- quantile(log_zwroty_nwg, probs = c(0.05, 0.5, 0.95))
mu
variance
std_dev
quantiles
histogram_zwrotów_ggplot
histogram_zwrotów_ggplot <- ggplot(
log_zwroty_nwgdf,
aes(x = log_zwroty, y = after_stat(density))
) +
geom_histogram(fill = "grey", color = "black") +
labs(title = NULL, x = "log-zwroty (%)", y = "Gęstość")
histogram_zwrotów_ggplot
wykres_zwrotów <- ggplot(log_zwroty_nwgdf, aes(x = data, y = log_zwroty, group = 1)) +
geom_line(color = "blue") +
labs(x = NULL, y = "log-zwroty (%)") +
scale_x_date(
date_breaks = "1 month",
date_labels = "%b %Y",
limits = c(min(kurs_data_cut), max(kurs_data_cut))
) +
theme(axis.text.x = element_text(angle = 50, vjust = 1, hjust = 1))
wykres_zwrotów
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
wykres_kwantyli <- ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = NULL, x = "Log-Zwroty", y = "Częstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
wykres_kwantyli
# Tworzenie histogramu z naniesionymi liniami dla średniej i kwantyli
wykres_kwantyli <- ggplot(log_zwroty_nwgdf, aes(x = log_zwroty_nwg)) +
geom_histogram(binwidth = 0.01, fill = "grey", color = "black", alpha = 0.7) + # Histogram
geom_vline(aes(xintercept = mu, color = "Średnia"), linetype = "dashed", size = 1) + # Średnia
geom_vline(aes(xintercept = quantiles[1], color = "Kwantyl 5%"), linetype = "dotted", size = 1) + # Kwantyl 5%
geom_vline(aes(xintercept = quantiles[2], color = "Mediana"), linetype = "dotted", size = 1) + # Mediana
geom_vline(aes(xintercept = quantiles[3], color = "Kwantyl 95%"), linetype = "dotted", size = 1) + # Kwantyl 95%
scale_color_manual(name = "Legenda",
values = c("Średnia" = "red",
"Kwantyl 5%" = "blue",
"Mediana" = "green",
"Kwantyl 95%" = "orange")) + # Kolory i etykiety legendy
labs(title = NULL, x = "Log-Zwroty", y = "Gęstość") + # Tytuły osi i wykresu
theme_minimal() + # Minimalny styl wykresu
theme(legend.position = "top") # Ustawienie legendy na górze
wykres_kwantyli
ggsave(
"img/estymacja_kwantyli_nwg.png",
plot = wykres_kwantyli,
width = 12,
height = 9,
units = "cm",
dpi = 480
)
#-----------------------------------------
# Estymacja kwantyli 0.05, 0.5, 0.95
#-----------------------------------------
# Wartość oczekiwana
mu <- mean(log_zwroty_nwg)
# Wariancja
variance <- var(log_zwroty_nwg)
# Odchylenie standardowe
std_dev <- sqrt(variance)
# Kwantyle
quantiles <- quantile(log_zwroty_nwg, probs = c(0.05, 0.5, 0.95))
mu
variance
std_dev
quantiles
